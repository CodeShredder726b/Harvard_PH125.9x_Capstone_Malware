---
title: "Report on Malware classification"
subtitle: "HarvardX Data Science Capstone Project"
author: "Raphael Kummer"
date: "`r format(Sys.Date())`"
output: 
  pdf_document:
    df_print: kable
    toc: yes
bibliography: references.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, progress = TRUE, verbose = TRUE)
```
\newpage
# Malware
## Introduction
Malware, short for "malicious software", is a type of software designed to cause harm or damage to computer systems, networks, or devices. Malware can take various forms, including viruses, worms, Trojan horses, ransomware, spyware, adware, and others. Malware can be spread through various means such as email attachments, infected websites, or through exploiting security vulnerabilities in software or operating systems. Malware can cause a range of issues such as stealing personal information, encrypting files and demanding ransom, disrupting system operations, and causing damage to hardware or software components. As such, it is important to have proper security measures in place, such as antivirus software, firewalls, and regular software updates to protect against malware attacks.

### Dataset
The dataset *Malware static and dynamic features VxHeaven and Virus Total Data Set* [2] from the UCI Machine Learning Repository contains three csv. 

* staDynBenignLab.csv: 1086 features extracted from 595 files on MS Windows 7 and 8, obtained Program Files directory.
* staDynVxHeaven2698Lab.csv: 1087 features extracted from 2698 files of VxHeaven dataset.
* staDynVt2955Lab.csv: 1087 features extracted from 2955 provided by Virus Total in 2018.

The staDynBenignLab has all the features of typical non-threatening programs wheare as staDynVxHeaven2698Lab and staDynVt2955Lab are extracted features of malware programs from the databases of VxHeaven and Virus Total. 
The dataset provides static features like ASM, compiler version, operating system version, Hex dump and PE header [3] (portable executable) and dynamic features extracted from a cuckoo sandbox [4].
The dataset only contains windows specific programs and malware.

## Initial setup
Download the dataset from the UCI Machine Learning Repository Dataset and extract the containing csv files. Add a label to each of the csv, describing the class of program identified (e.g. class 0 for benign, class 1 for static malware features and class 2 for dynamic malware features).

## Goal
The dataset is used to explore and gain insight on how normal programs and malware differ in static and dynamic structure. Several machine learning algorithms to classify an unseen program as benign or malware (static or dynamic) are developed and compared.
Overall, the goal of this project is to improve our understanding of how malware differs from normal programs, and to develop effective techniques for automatically identifying and classifying malware based on its static and dynamic features.

## Summary
<TODO>

# Analysis
## Download
The zipped dataset is downloaded from the UCI archive and unzipped. 
  
```{r echo=FALSE, warning=FALSE}
# download dataset from UCI archive https://archive.ics.uci.edu/ml/datasets/Malware+static+and+dynamic+features+VxHeaven+and+Virus+Total#
download_url <- 'https://archive.ics.uci.edu/ml/machine-learning-databases/00541/datasets_DetectingMalwareUsingAHybridApproach.zip'
download.file(download_url, 'datasets.zip', mode='wb')

# unzip
unzip_result <- unzip("datasets.zip", overwrite = TRUE)
```
  
This will extract the following files:
```{r echo=TRUE}
list.files()
  
 # load these csv
benign <- read_csv("staDynBenignLab.csv")
vxheaven <- read_csv("staDynVxHeaven2698Lab.csv")
vt <- read_csv("staDynVt2955Lab.csv")
 ```
Where 
- *staDynBenignLab.csv* has `r { ncol(benign) }` features extracted from `r { nrow(benign) }` files on MS Windows 7 and 8, obtained Program Files directory
- *staDynVxHeaven2698Lab.csv* has `r { ncol(vxheaven) }` features extracted from `r { nrow(vxheaven) }` files of VxHeaven dataset.
- *staDynVt2955Lab.csv* has `r { ncol(vt) }` features extracted from `r { nrow(vt) }` provided by Virus Total in 2018.

## Preprocessing
Add classes to each dataset, depending on the origin of their data:
      
0: Normal *benign* programs 
1: Malware with static features extracted from the *VxHeaven (vxheaven)* dataset
2: Malware with dynamic features extracted from the *Virus Total (vt)* dataset

```
# classify each dataset
benign$class <- 0
vxheaven$class <- 1
vt$class <- 2
```
  
## Cleanup
The datasets have staDynBenignLab: `r sum(is.na(benign))`, staDynVxHeaven2698Lab: `r sum(is.na(vxheaven))` and staDynVt2955Lab: `r sum(is.na(vt))` missing values.

Check for features that not present in all three datasets, remove unique columns and combine all in one large dataset. 
```{r echo=FALSE}     
# remove unique columns
benign <- benign[, common_cols]
vxheaven <- vxheaven[, common_cols]
vt <- vt[, common_cols]
# now each dataset has 1085 features
      
# create one large dataset 
data <- rbind(benign, vxheaven, vt)
```
The resulting dataset we now work with has `r { ncol(benign) }` features for each of the `r { nrow(benign) }` different programs.

## Inspection


# Models
## Guessing
## SVM
## KNN
## Random Forest
## Naive Bayes
## Decision Trees
## Gradient Boosting

# Conclusion
## Future Improvements

* Neuronal Network
* Gradient Descent

# System
## Hardware
All above computations are done with an `r {get_cpu().model_name}` CPU with `r {get_cpu().no_of_cores}` and `r {get_ram()}`` of RAM.
```{r}
#get_cpu()
#get_ram()
```

## Software
This report is compiled using R markdown with RStudio.
```{r}
sessionInfo()
```

# Resources
[1] Rafael Irizarry. 2018. Introduction to Data Science. <https://rafalab.dfci.harvard.edu/dsbook/>
[2] Malware static and dynamic features VxHeaven and Virus Total Data Set <https://archive.ics.uci.edu/ml/datasets/Malware+static+and+dynamic+features+VxHeaven+and+Virus+Total#>
[3] PE Format <https://learn.microsoft.com/en-us/windows/win32/debug/pe-format>
[4] cuckoo sandbox <https://cuckoosandbox.org/>

